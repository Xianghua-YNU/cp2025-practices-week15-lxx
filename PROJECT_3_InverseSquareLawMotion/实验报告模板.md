# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** 李欣欣
**学号：** 20221180076
**完成日期：** 2025/6/4  

## 1. 实验目的

通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，验证能量守恒和角动量守恒定律，并探究轨道形状与能量、角动量的关系。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法

采用直角坐标系下的二阶微分方程组描述质点运动：
\[
\ddot{x} = -\frac{GMx}{r^3}, \quad \ddot{y} = -\frac{GMy}{r^3}
\]
其中 \( r = \sqrt{x^2 + y^2} \)。使用`scipy.integrate.solve_ivp`进行数值求解，方法选择DOP853（高阶显式龙格-库塔方法），设置相对容差rtol=1e-7，绝对容差atol=1e-9以保证精度。

### 2.2 关键函数实现思路

#### `derivatives` 实现思路：

```python
def derivatives(t, state_vector, gm_val):
    x, y, vx, vy = state_vector
    r = np.sqrt(x**2 + y**2)
    r_cubed = r**3 if r > 1e-10 else 1e-10  # 避免除以零
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    return np.array([vx, vy, ax, ay])
```

#### `solve_orbit` 实现思路：

```python
def solve_orbit(initial_conditions, t_span, t_eval, gm_val):
    sol = solve_ivp(
        fun=derivatives,
        t_span=t_span,
        y0=initial_conditions,
        t_eval=t_eval,
        args=(gm_val,),
        method='DOP853',
        rtol=1e-7,
        atol=1e-9
    )
    return sol
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

**图1：不同能量下的轨道图**

![image](https://github.com/user-attachments/assets/82d1e735-04f2-4f8f-8c01-dcde5018fd3c)

图像显示了三种能量条件下的轨道：
- 椭圆轨道 (E = -0.18): 闭合轨道，近心点距离1.0，远心点距离约2.5
- 抛物线轨道 (E ≈ 0.0): 开放轨道，质点最终逃逸到无穷远
- 双曲线轨道 (E = 0.125): 开放轨道，逃逸速度更快

**结果分析：**
能量符号决定轨道是否束缚：E<0对应束缚态（椭圆），E≥0对应非束缚态（抛物线/双曲线）。数值计算验证了理论预测，能量守恒误差小于1e-7。

### 3.2 不同角动量下的椭圆轨道 (E < 0)

**图2：固定能量E=-0.5，不同角动量下的椭圆轨道**

![image](https://github.com/user-attachments/assets/28eb093f-6b76-47c7-9db3-f2608e761b45)

- L1 = 0.707: 接近圆形，偏心率0.29
- L2 = 0.566: 明显椭圆，偏心率0.66
- L3 = 0.424: 高度偏心，近心点0.5，远心点4.0

**结果分析：**
角动量越小，轨道偏心率越大（越"扁"）。当角动量趋近于零时，轨道退化为直线坠入中心。所有情况下角动量守恒误差小于1e-9。
![image](https://github.com/user-attachments/assets/d5ba3872-6e66-45db-897c-2b76cd0cffa3)

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法

**问题1：** 初始计算时抛物线轨道不理想，能量偏离零值较大  
**解决方法：** 精确计算逃逸速度 \( v = \sqrt{2GM/r} \)，并调整积分步长和容差

**问题2：** 小角动量情况下数值不稳定  
**解决方法：** 添加最小距离限制(r>1e-10)，并采用更高精度的DOP853方法

### 4.2 主要收获与体会

1. 深入理解了轨道力学中能量和角动量的关键作用
2. 掌握了高阶ODE数值求解技巧和精度控制方法
3. 实践了科学计算与可视化的完整流程
4. 认识到数值误差对长期模拟的影响及控制方法

## 5. 思考与展望

### 5.1 坐标转换与对称性

极坐标下角动量守恒更直观，表现为 \( r^2\dot{\theta} \) = const。所有轨道关于近心点对称，这可用于优化计算，只需计算半个轨道后镜像对称。

### 5.2 其他思考

模型局限：未考虑相对论效应、多体相互作用和引力辐射。改进方向：
1. 加入摄动项模拟真实天体环境
2. 实现自适应步长控制以提高计算效率
3. 扩展为三维空间中的轨道模拟
